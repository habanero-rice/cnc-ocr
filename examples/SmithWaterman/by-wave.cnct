////////////////////////////////////////////////////////////////////////////////
// Wavefront-based tuning
////////////////////////////////////////////////////////////////////////////////


////////////////////////////////////////////////////////////////////////////////
// item collection distributions

[ above : i, j ] : { wave_dist(i, j, #ntw, $RANKS) };    // Last row of tile above
[ left  : i, j ] : { wave_dist(i, j, #ntw, $RANKS) };    // Last column of tile to the left

////////////////////////////////////////////////////////////////////////////////
// compute group distributions

( initAboveStep : tw, ntw ): { 0 };
( initLeftStep  : th, nth ): { 0 };
( swStep        :  i,   j ): { wave_dist(i, j, #ntw, $RANKS) };


////////////////////////////////////////////////////////////////////////////////
// compute group affinities

( $INIT: () ) ->
    ( initAboveStep: #tw, #ntw ),
    ( initLeftStep: #th, #nth ),
    ( swStep: $RANGE(0, #nth), $RANGE(0, #ntw) );

